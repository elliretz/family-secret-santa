{"note":"import streamlit as st\nimport json\nimport random\nimport os\n\n# === CONFIGURATION ===\nPARTICIPANTS = [\n    \"Emme\", \"Zack\", \"Natalie\", \"Sam\", \"Laura\", \"Kirk\",\n    \"Erin\", \"Dave\", \"Adrienne\", \"Caleb\", \"Ellie\",\n    \"Maggie\", \"Joe\", \"Amber\"\n]\n\n# Group restrictions\nGROUP_1 = {\"Ellie\", \"Adrienne\", \"Dave\", \"Erin\", \"Caleb\"}\nGROUP_2 = {\"Natalie\", \"Emme\", \"Sam\", \"Laura\", \"Kirk\", \"Zack\"}\nGROUP_3 = {\"Amber\", \"Maggie\", \"Joe\"}\n\n# === FILE STORAGE ===\nHISTORY_FILE = \"secret_santa_history.json\"\n\n# Load past assignments (2023‚Äì2024)\nPAST_ASSIGNMENTS = {\n    \"2023\": {\n        \"Ellie\": \"Sam\", \"Dave\": \"Laura\", \"Joe\": \"Zack\", \"Zack\": \"Caleb\",\n        \"Sam\": \"Erin\", \"Kirk\": \"Adrienne\", \"Erin\": \"Kirk\", \"Maggie\": \"Emme\",\n        \"Emme\": \"Joe\", \"Natalie\": \"Dave\", \"Laura\": \"Maggie\",\n        \"Amber\": \"Ellie\", \"Adrienne\": \"Amber\", \"Caleb\": \"Natalie\"\n    },\n    \"2024\": {\n        \"Natalie\": \"Ellie\", \"Dave\": \"Emme\", \"Emme\": \"Amber\",\n        \"Adrienne\": \"Sam\", \"Ellie\": \"Zack\", \"Caleb\": \"Kirk\",\n        \"Erin\": \"Natalie\", \"Maggie\": \"Erin\", \"Sam\": \"Maggie\",\n        \"Zack\": \"Adrienne\", \"Laura\": \"Caleb\", \"Amber\": \"Dave\",\n        \"Kirk\": \"Joe\", \"Joe\": \"Laura\"\n    }\n}\n\n# Load history (create file if not present)\nif os.path.exists(HISTORY_FILE):\n    with open(HISTORY_FILE, \"r\") as f:\n        history = json.load(f)\nelse:\n    history = {}\n\n# Merge static past assignments\nhistory.update(PAST_ASSIGNMENTS)\n\n# === FUNCTION: Get allowed recipients ===\ndef get_allowed_recipients(giver):\n    if giver in GROUP_1:\n        return {\"Natalie\", \"Emme\", \"Joe\", \"Amber\", \"Maggie\", \"Sam\", \"Zack\", \"Laura\", \"Kirk\"}\n    elif giver in GROUP_2:\n        return {\"Ellie\", \"Adrienne\", \"Erin\", \"Dave\", \"Amber\", \"Maggie\", \"Joe\", \"Caleb\"}\n    elif giver in GROUP_3:\n        return {\"Natalie\", \"Emme\", \"Sam\", \"Zack\", \"Laura\", \"Kirk\", \"Caleb\", \"Ellie\", \"Adrienne\", \"Erin\", \"Dave\"}\n    else:\n        return set(PARTICIPANTS)\n\n# === FUNCTION: Generate new year ===\ndef generate_new_year(history):\n    current_year = max(map(int, history.keys())) + 1 if history else 2025\n    used_pairs = {(giver, rec) for year in history.values() for giver, rec in year.items()}\n    \n    # Try random permutations until valid\n    for _ in range(100000):\n        receivers = random.sample(PARTICIPANTS, len(PARTICIPANTS))\n        assignment = dict(zip(PARTICIPANTS, receivers))\n        if all(\n            giver != rec and\n            (giver, rec) not in used_pairs and\n            rec in get_allowed_recipients(giver)\n            for giver, rec in assignment.items()\n        ):\n            history[str(current_year)] = assignment\n            with open(HISTORY_FILE, \"w\") as f:\n                json.dump(history, f, indent=2)\n            return current_year, assignment\n    return None, None\n\n# === STREAMLIT UI ===\nst.title(\"üéÖ Family Secret Santa Generator\")\n\nif st.button(\"üéÅ Generate Next Year's Assignments\"):\n    year, new_assignments = generate_new_year(history)\n    if year:\n        st.success(f\"‚úÖ Generated Secret Santa assignments for {year}!\")\n        for giver, rec in new_assignments.items():\n            st.write(f\"**{giver} ‚ûú {rec}**\")\n    else:\n        st.error(\"‚ö†Ô∏è Could not generate a valid assignment after many attempts.\")\n\nif history:\n    st.subheader(\"üìú Past Assignments\")\n    for year in sorted(history.keys(), reverse=True):\n        with st.expander(f\"{year}\"):\n            for giver, rec in history[year].items():\n                st.write(f\"{giver} ‚Üí {rec}\")","bgColorIndex":0,"textColorIndex":0}